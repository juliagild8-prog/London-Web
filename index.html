<!--
  London Guide â€” Single-file (index.html)
  FIXED: Every neighborhood now shows the FULL expanded Discover list
  because each neighborhood uses:
    categories: [...BASE_CATEGORIES, ...BONUS_CATEGORIES]

  Paste this entire file into your GitHub repo as: index.html
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>London Guide</title>

  <style>
    :root {
      --bg: #f7f9ff;
      --bg-2: #ffffff;
      --card: rgba(255, 255, 255, 0.75);
      --card-solid: #ffffff;
      --border: rgba(15, 23, 42, 0.10);
      --shadow: 0 18px 45px rgba(2, 6, 23, 0.08);

      --text: #0f172a;
      --muted: rgba(15, 23, 42, 0.68);
      --muted-2: rgba(15, 23, 42, 0.52);

      --accent: #2563eb;
      --accent-2: #7c3aed;

      --radius: 16px;
      --radius-sm: 12px;

      --gap: 16px;
      --pad: 18px;

      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }

    body {
      margin: 0;
      font-family: var(--font);
      color: var(--text);
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(37, 99, 235, 0.10), transparent 55%),
        radial-gradient(1100px 700px at 85% 25%, rgba(124, 58, 237, 0.10), transparent 55%),
        radial-gradient(900px 700px at 40% 90%, rgba(34, 197, 94, 0.08), transparent 55%),
        linear-gradient(180deg, var(--bg), #fdfdff 45%, #ffffff);
    }

    a { color: inherit; text-decoration: none; }
    button { font-family: inherit; }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 24px 18px 30px;
    }

    header {
      display: flex;
      gap: 14px;
      align-items: baseline;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .title-wrap h1 {
      margin: 0;
      font-size: clamp(26px, 3vw, 34px);
      letter-spacing: -0.02em;
    }

    .title-wrap p {
      margin: 6px 0 0;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.45;
      max-width: 70ch;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border: 1px solid var(--border);
      background: rgba(255, 255, 255, 0.65);
      border-radius: 999px;
      box-shadow: 0 10px 30px rgba(2, 6, 23, 0.06);
      color: var(--muted);
      font-size: 13px;
      white-space: nowrap;
    }
    .dot {
      width: 9px;
      height: 9px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      box-shadow: 0 8px 18px rgba(37, 99, 235, 0.25);
    }

    .grid {
      display: grid;
      grid-template-columns: 1.05fr 1fr 1.6fr;
      gap: var(--gap);
      align-items: stretch;
      min-height: 640px;
    }

    .panel {
      border: 1px solid var(--border);
      background: var(--card);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .panel header.panel-header {
      padding: 14px var(--pad);
      border-bottom: 1px solid var(--border);
      background: rgba(255, 255, 255, 0.55);
    }

    .panel header.panel-header h2 {
      font-size: 14px;
      margin: 0;
      letter-spacing: 0.02em;
      color: var(--muted);
      text-transform: uppercase;
    }

    .panel-body {
      padding: var(--pad);
      display: flex;
      flex-direction: column;
      gap: 12px;
      flex: 1;
      min-height: 0;
    }

    /* Neighborhoods */
    .neighborhoods {
      display: flex;
      flex-direction: column;
      gap: 10px;
      overflow: auto;
      padding-right: 4px;
    }

    .nb-btn {
      width: 100%;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.72);
      border-radius: var(--radius-sm);
      padding: 12px 12px;
      text-align: left;
      cursor: pointer;
      transition: transform 120ms ease, border-color 120ms ease, box-shadow 120ms ease;
    }
    .nb-btn:hover { transform: translateY(-1px); }
    .nb-btn:focus { outline: 2px solid rgba(37, 99, 235, 0.35); outline-offset: 2px; }
    .nb-btn.active {
      border-color: rgba(37, 99, 235, 0.45);
      box-shadow: 0 14px 35px rgba(37, 99, 235, 0.14);
      background: linear-gradient(180deg, rgba(37, 99, 235, 0.09), rgba(255,255,255,0.78));
    }

    .nb-top { display: flex; align-items: center; justify-content: space-between; gap: 10px; }
    .nb-name { font-weight: 650; letter-spacing: -0.01em; }
    .nb-tag {
      font-size: 12px;
      color: var(--muted);
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.65);
      padding: 6px 10px;
      border-radius: 999px;
      white-space: nowrap;
    }
    .nb-desc { margin-top: 8px; font-size: 13px; color: var(--muted-2); line-height: 1.35; }

    /* Categories */
    .subhead {
      color: var(--muted);
      font-size: 13px;
      line-height: 1.35;
      margin-top: -2px;
    }

    .category-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      overflow: auto;
      padding-right: 4px;
    }

    .cat-btn {
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.72);
      border-radius: 14px;
      padding: 12px 12px;
      cursor: pointer;
      text-align: left;
      transition: transform 120ms ease, border-color 120ms ease, box-shadow 120ms ease;
      min-height: 52px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 4px;
    }
    .cat-btn:hover { transform: translateY(-1px); }
    .cat-btn:focus { outline: 2px solid rgba(124, 58, 237, 0.30); outline-offset: 2px; }
    .cat-btn.active {
      border-color: rgba(124, 58, 237, 0.45);
      box-shadow: 0 14px 35px rgba(124, 58, 237, 0.13);
      background: linear-gradient(180deg, rgba(124, 58, 237, 0.08), rgba(255,255,255,0.78));
    }
    .cat-name { font-weight: 650; font-size: 14px; }
    .cat-hint { color: var(--muted-2); font-size: 12px; }

    .actions { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 2px; }
    .action-btn {
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.78);
      border-radius: 999px;
      padding: 10px 12px;
      cursor: pointer;
      font-weight: 600;
      font-size: 13px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: transform 120ms ease, box-shadow 120ms ease, border-color 120ms ease;
    }
    .action-btn:hover { transform: translateY(-1px); }
    .action-btn.primary {
      border-color: rgba(37, 99, 235, 0.35);
      box-shadow: 0 16px 34px rgba(37, 99, 235, 0.14);
    }
    .mini-dot { width: 9px; height: 9px; border-radius: 50%; background: rgba(15,23,42,0.25); }
    .action-btn.primary .mini-dot { background: linear-gradient(135deg, var(--accent), var(--accent-2)); }

    /* Map */
    .map-wrap { display: flex; flex-direction: column; gap: 10px; min-height: 0; }
    .map-meta {
      display: flex;
      flex-direction: column;
      gap: 6px;
      padding: 12px 14px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.72);
      border-radius: var(--radius-sm);
    }
    .map-meta .k { font-size: 12px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.06em; }
    .map-meta .v { font-size: 14px; font-weight: 650; letter-spacing: -0.01em; }
    .map-meta .q { font-size: 13px; color: var(--muted); line-height: 1.35; word-break: break-word; }

    iframe {
      width: 100%;
      height: 100%;
      border: 0;
      border-radius: var(--radius);
      box-shadow: 0 18px 45px rgba(2, 6, 23, 0.10);
      background: var(--card-solid);
      min-height: 420px;
    }

    .note {
      margin-top: 14px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.45;
      padding: 12px 14px;
      border: 1px dashed rgba(15,23,42,0.18);
      border-radius: var(--radius);
      background: rgba(255,255,255,0.55);
    }

    @media (max-width: 980px) {
      .grid { grid-template-columns: 1fr; min-height: auto; }
      iframe { min-height: 380px; }
      header { flex-direction: column; align-items: flex-start; }
      .chip { align-self: flex-start; }
    }
    @media (max-width: 420px) {
      .category-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <div class="title-wrap">
        <h1>London Guide</h1>
        <p>
          Explore London by neighborhood, then tap a category to instantly search live on Google Maps â€”
          no static lists, just curated discovery.
        </p>
      </div>
      <div class="chip" title="Tip: pick a neighborhood, then pick a category">
        <span class="dot" aria-hidden="true"></span>
        Live Google Maps searches
      </div>
    </header>

    <main class="grid" aria-label="London Guide layout">
      <section class="panel" aria-label="Neighborhoods">
        <header class="panel-header">
          <h2>Neighborhoods</h2>
        </header>
        <div class="panel-body">
          <div class="neighborhoods" id="neighborhoodList" role="list"></div>
          <div class="note">
            <strong>How it works:</strong> select a neighborhood (left), then choose what youâ€™re in the mood for (middle).
            The map updates to a live search query (right).
          </div>
        </div>
      </section>

      <section class="panel" aria-label="Categories">
        <header class="panel-header">
          <h2>Discover</h2>
        </header>
        <div class="panel-body">
          <div class="subhead" id="selectedNeighborhoodLabel">Select a neighborhood to see categories.</div>

          <div class="category-grid" id="categoryGrid" aria-label="Category buttons"></div>

          <div class="actions" aria-label="Actions">
            <button class="action-btn primary" id="showOnMapBtn" type="button" title="Update the embedded map">
              <span class="mini-dot" aria-hidden="true"></span>
              Show on map
            </button>
            <button class="action-btn" id="openInMapsBtn" type="button" title="Open Google Maps in a new tab">
              <span class="mini-dot" aria-hidden="true"></span>
              Open in Maps
            </button>
          </div>
        </div>
      </section>

      <section class="panel" aria-label="Map">
        <header class="panel-header">
          <h2>Map</h2>
        </header>
        <div class="panel-body map-wrap">
          <div class="map-meta" aria-live="polite">
            <div class="k">Current selection</div>
            <div class="v" id="currentSelectionTitle">â€”</div>
            <div class="q" id="currentQueryText">Pick a neighborhood and category to load a live Google Maps search.</div>
          </div>

          <iframe
            id="mapFrame"
            title="Google Map"
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
            src="https://www.google.com/maps?q=London&output=embed"></iframe>
        </div>
      </section>
    </main>
  </div>

  <script>
    /* =========================================================
       DATA
       ========================================================= */

    // Big list that should show for EVERY neighborhood
    const BASE_CATEGORIES = [
      // ðŸ½ Food & Drink
      { id: "coffee",   label: "Coffee",     hint: "CafÃ©s + espresso bars",  query: "coffee" },
      { id: "brunch",   label: "Brunch",     hint: "Late morning favorites", query: "brunch" },
      { id: "lunch",    label: "Lunch",      hint: "Great midday bites",     query: "lunch" },
      { id: "dinner",   label: "Dinner",     hint: "Sit-down favorites",     query: "dinner" },
      { id: "bakery",   label: "Bakeries",   hint: "Pastries & sweets",      query: "bakery" },
      { id: "dessert",  label: "Dessert",    hint: "Sweet treat stops",      query: "dessert" },
      { id: "italian",  label: "Italian",    hint: "Pasta & pizza",          query: "italian restaurant" },

      // ðŸ¸ Nightlife
      { id: "pubs",      label: "Pubs",         hint: "Classic pints & vibes", query: "pub" },
      { id: "cocktails", label: "Cocktails",    hint: "Craft cocktail bars",   query: "cocktail bar" },
      { id: "wine",      label: "Wine Bars",    hint: "Casual wine spots",     query: "wine bar" },
      { id: "rooftop",   label: "Rooftop Bars", hint: "Drinks with a view",    query: "rooftop bar" },

      // ðŸƒâ€â™€ï¸ Workout & Wellness
      { id: "pilates",   label: "Pilates",    hint: "Studios & reformer",     query: "pilates studio" },
      { id: "yoga",      label: "Yoga",       hint: "Flow & hot yoga",        query: "yoga studio" },
      { id: "barre",     label: "Barre",      hint: "Low-impact classes",     query: "barre class" },
      { id: "spin",      label: "Spin",       hint: "Cycling classes",        query: "spin class" },
      { id: "gym",       label: "Gyms",       hint: "Fitness centers",        query: "gym" },
      { id: "running",   label: "Running",    hint: "Popular routes nearby",  query: "running route" },
      { id: "spa",       label: "Spa",        hint: "Relax & unwind",         query: "spa" },
      { id: "sauna",     label: "Sauna",      hint: "Heat & recovery",        query: "sauna" },

      // ðŸ› Shopping
      { id: "vintage",   label: "Vintage",     hint: "Thrift & secondhand",   query: "vintage shop" },
      { id: "antiques",  label: "Antiques",    hint: "Antique stores",        query: "antique store" },
      { id: "boutiques", label: "Boutiques",   hint: "Independent shops",     query: "boutique shop" },
      { id: "bookshops", label: "Bookshops",   hint: "Local bookstores",      query: "bookshop" },
      { id: "markets",   label: "Markets",     hint: "Food + street markets", query: "market" },

      // ðŸŽ­ Culture & Outdoors
      { id: "museums",   label: "Museums",      hint: "Galleries & exhibits", query: "museum" },
      { id: "art",       label: "Art Galleries",hint: "Contemporary & classic",query: "art gallery" },
      { id: "theatre",   label: "Theatre",      hint: "Shows & performances", query: "theatre" },
      { id: "music",     label: "Live Music",   hint: "Venues & gigs",         query: "live music" },
      { id: "parks",     label: "Parks",        hint: "Green space escapes",  query: "park" },
      { id: "walks",     label: "Scenic Walks", hint: "Stroll-worthy routes", query: "scenic walk" },
      { id: "views",     label: "Views",        hint: "Lookouts & skyline",    query: "best views" },

      // âœ¨ Discovery
      { id: "hidden",    label: "Hidden Gems",  hint: "Off-the-beaten-path",  query: "hidden gems" },
      { id: "local",     label: "Local Favorites", hint: "Loved by locals",   query: "local favorite" }
    ];

    // IMPORTANT: Every neighborhood uses [...BASE_CATEGORIES, ...BONUSES]
    // so the big list shows everywhere.
    const NEIGHBORHOODS = [
      {
        id: "soho",
        name: "Soho",
        tag: "Food + nightlife",
        desc: "Buzzing streets with restaurants, bars, and late-night energy.",
        categories: [
          ...BASE_CATEGORIES,
          { id: "soho_speakeasy", label: "Speakeasies", hint: "Hidden cocktail vibes", query: "speakeasy bar" }
        ]
      },
      {
        id: "shoreditch",
        name: "Shoreditch",
        tag: "Street art",
        desc: "Trendy, creative, and packed with markets, coffee, and bars.",
        categories: [
          ...BASE_CATEGORIES,
          { id: "shrd_streetart", label: "Street Art", hint: "Murals & walks", query: "street art" }
        ]
      },
      {
        id: "nottinghill",
        name: "Notting Hill",
        tag: "Colorful",
        desc: "Pastel houses, markets, and cozy cafÃ©sâ€”picture-perfect wandering.",
        categories: [
          ...BASE_CATEGORIES,
          { id: "nh_portobello", label: "Portobello Market", hint: "Iconic stalls & antiques", query: "Portobello Road Market" }
        ]
      },
      {
        id: "kensington",
        name: "Kensington",
        tag: "Museums",
        desc: "Elegant streets, major museums, and classic London charm.",
        categories: [
          ...BASE_CATEGORIES,
          { id: "ken_tea", label: "Afternoon Tea", hint: "Classic tea spots", query: "afternoon tea" }
        ]
      },
      {
        id: "coventgarden",
        name: "Covent Garden",
        tag: "Central + cute",
        desc: "Great for shopping, theatres, and easy walking around central London.",
        categories: [
          ...BASE_CATEGORIES,
          { id: "cg_westend", label: "West End Shows", hint: "Theatres nearby", query: "west end theatre" }
        ]
      },
      {
        id: "southbank",
        name: "South Bank",
        tag: "Riverside",
        desc: "River walks, culture, and some of the best skyline moments.",
        categories: [
          ...BASE_CATEGORIES,
          { id: "sb_riverwalk", label: "Thames Walk", hint: "Scenic riverside route", query: "thames river walk" }
        ]
      },
      {
        id: "greenwich",
        name: "Greenwich",
        tag: "Maritime",
        desc: "Historic ships, museums, and big park views by the river.",
        categories: [
          ...BASE_CATEGORIES,
          { id: "gr_observatory", label: "Observatory", hint: "Prime Meridian views", query: "Royal Observatory Greenwich" }
        ]
      }
    ];

    /* =========================================================
       STATE
       ========================================================= */
    const state = {
      neighborhoodId: NEIGHBORHOODS[0].id,
      categoryId: null,
      queryString: ""
    };

    /* =========================================================
       DOM
       ========================================================= */
    const neighborhoodListEl = document.getElementById("neighborhoodList");
    const categoryGridEl = document.getElementById("categoryGrid");
    const selectedNeighborhoodLabelEl = document.getElementById("selectedNeighborhoodLabel");
    const currentSelectionTitleEl = document.getElementById("currentSelectionTitle");
    const currentQueryTextEl = document.getElementById("currentQueryText");
    const mapFrameEl = document.getElementById("mapFrame");
    const showOnMapBtn = document.getElementById("showOnMapBtn");
    const openInMapsBtn = document.getElementById("openInMapsBtn");

    /* =========================================================
       HELPERS
       ========================================================= */
    function getNeighborhoodById(id) {
      return NEIGHBORHOODS.find(n => n.id === id);
    }

    function getCategoryById(neighborhood, catId) {
      return (neighborhood.categories || BASE_CATEGORIES).find(c => c.id === catId);
    }

    function buildQuery(neighborhoodName, categoryQuery) {
      const parts = [];
      if (categoryQuery) parts.push(categoryQuery);
      parts.push(neighborhoodName);
      parts.push("London");
      return parts.join(" ").trim();
    }

    function mapsEmbedUrl(queryString) {
      const q = encodeURIComponent(queryString);
      return `https://www.google.com/maps?q=${q}&output=embed`;
    }

    function mapsOpenUrl(queryString) {
      const q = encodeURIComponent(queryString);
      return `https://www.google.com/maps/search/?api=1&query=${q}`;
    }

    function setActiveButton(container, selector, activeId) {
      container.querySelectorAll(selector).forEach(btn => {
        const isActive = btn.dataset.id === activeId;
        btn.classList.toggle("active", isActive);
        btn.setAttribute("aria-pressed", isActive ? "true" : "false");
      });
    }

    /* =========================================================
       RENDER
       ========================================================= */
    function renderNeighborhoods() {
      neighborhoodListEl.innerHTML = "";

      NEIGHBORHOODS.forEach(n => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "nb-btn";
        btn.dataset.id = n.id;
        btn.setAttribute("aria-pressed", "false");

        btn.innerHTML = `
          <div class="nb-top">
            <div class="nb-name">${n.name}</div>
            <div class="nb-tag">${n.tag}</div>
          </div>
          <div class="nb-desc">${n.desc}</div>
        `;

        btn.addEventListener("click", () => {
          state.neighborhoodId = n.id;
          const cats = getNeighborhoodById(state.neighborhoodId).categories || BASE_CATEGORIES;
          state.categoryId = cats[0]?.id || null;
          updateAll({ updateMap: true });
        });

        neighborhoodListEl.appendChild(btn);
      });

      setActiveButton(neighborhoodListEl, ".nb-btn", state.neighborhoodId);
    }

    function renderCategories() {
      const neighborhood = getNeighborhoodById(state.neighborhoodId);

      // Each neighborhood has categories (and each includes ...BASE_CATEGORIES)
      const categories = neighborhood.categories || BASE_CATEGORIES;

      categoryGridEl.innerHTML = "";

      if (!state.categoryId && categories.length) {
        state.categoryId = categories[0].id;
      }

      categories.forEach(c => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "cat-btn";
        btn.dataset.id = c.id;
        btn.setAttribute("aria-pressed", "false");

        btn.innerHTML = `
          <div class="cat-name">${c.label}</div>
          <div class="cat-hint">${c.hint || "Search in this area"}</div>
        `;

        btn.addEventListener("click", () => {
          state.categoryId = c.id;
          updateAll({ updateMap: true });
        });

        categoryGridEl.appendChild(btn);
      });

      setActiveButton(categoryGridEl, ".cat-btn", state.categoryId);
      selectedNeighborhoodLabelEl.textContent =
        `In ${neighborhood.name}: choose a category to explore on Google Maps.`;
    }

    function updateMapAndMeta({ updateMap }) {
      const neighborhood = getNeighborhoodById(state.neighborhoodId);
      const category = state.categoryId ? getCategoryById(neighborhood, state.categoryId) : null;

      const categoryLabel = category?.label || "Explore";
      const categoryQuery = category?.query || "";

      state.queryString = buildQuery(neighborhood.name, categoryQuery);

      currentSelectionTitleEl.textContent = `${neighborhood.name} â€¢ ${categoryLabel}`;
      currentQueryTextEl.textContent = `Search query: â€œ${state.queryString}â€`;

      if (updateMap) mapFrameEl.src = mapsEmbedUrl(state.queryString);
    }

    function updateAll({ updateMap }) {
      setActiveButton(neighborhoodListEl, ".nb-btn", state.neighborhoodId);
      renderCategories();
      setActiveButton(categoryGridEl, ".cat-btn", state.categoryId);
      updateMapAndMeta({ updateMap });
    }

    /* =========================================================
       ACTIONS
       ========================================================= */
    showOnMapBtn.addEventListener("click", () => updateMapAndMeta({ updateMap: true }));

    openInMapsBtn.addEventListener("click", () => {
      if (!state.queryString) return;
      window.open(mapsOpenUrl(state.queryString), "_blank", "noopener,noreferrer");
    });

    /* =========================================================
       INIT
       ========================================================= */
    function init() {
      renderNeighborhoods();
      const defaultNeighborhood = getNeighborhoodById(state.neighborhoodId);
      const defaultCategories = defaultNeighborhood.categories || BASE_CATEGORIES;
      state.categoryId = defaultCategories[0]?.id || null;
      updateAll({ updateMap: true });
    }

    init();
  </script>
</body>
</html>
